# TODOアプリ 優先度自動調整機能 要件定義書

**文書作成日**: 2025年11月24日 04:48:53 JST
**最終更新日**: 2025年11月24日 04:56:17 JST
**バージョン**: 1.1
**対象システム**: TODOアプリ（個人利用向け）

**変更履歴**:
- v1.1 (2025年11月24日 04:56:17 JST): 手動優先度調整機能の詳細化、UI機能の明示化、リセット機能の追加
- v1.0 (2025年11月24日 04:48:53 JST): 初版作成

---

## 1. 機能概要

TODOアプリにおいて、タスクの状態変化に応じて自動的に優先度を調整する機能を実装する。この機能により、ユーザーは重要なタスクを見落とすことなく、効率的にタスク管理を行うことができる。

---

## 2. 機能の目的

### 2.1 主要目的
- **重要なタスクの見落とし防止**: タスクの状況に応じて優先度を動的に調整し、緊急性の高いタスクを常に可視化する
- **正確なタスク管理の実現**: ユーザーが手動で優先度を管理する負担を軽減し、システムが適切な優先度を提案する

### 2.2 副次的目的
- タスク管理の効率化
- ユーザーの認知負荷の軽減
- タスクの完了率向上

---

## 3. 主要な機能仕様

### 3.1 優先度の種類

システムでは以下の4段階の優先度を扱う：

| 優先度レベル | 名称 | 説明 |
|------------|------|------|
| 1 | 緊急 | 即座に対応が必要なタスク |
| 2 | 重要 | 近日中に対応が必要なタスク |
| 3 | 通常 | 通常の期限内に対応するタスク |
| 4 | 低優先度 | 時間があるときに対応するタスク |

### 3.2 自動調整のトリガー

以下のタスク状態変化時に優先度の自動調整を実行する：

- **タスクの新規追加時**
- **タスクの完了時**
- **タスクの更新時**（期限、内容、依存関係などの変更）
- **タスクの種類変更時**

### 3.3 手動優先度調整機能

#### 3.3.1 UI機能
ユーザーが任意のタイミングで優先度を手動変更できる機能を提供する：

- **優先度変更UI**: タスク詳細画面またはタスク一覧から優先度を変更可能
- **変更方法**: ドロップダウン、ボタン、またはドラッグ&ドロップで優先度を選択
- **即時反映**: 手動で変更した優先度は即座にタスクに反映される
- **変更履歴**: 手動変更の履歴を記録（誰がいつ変更したかを追跡可能）

#### 3.3.2 手動設定と自動調整の共存

- ユーザーが手動で設定した優先度は**最優先**とする
- 自動調整機能は手動設定された優先度を**上書きしない**
- 手動設定フラグを保持し、自動調整の対象外とする
- ユーザーが手動設定をリセット（解除）できる機能を提供する

#### 3.3.3 手動設定のリセット機能

ユーザーが自動調整を再度有効にしたい場合：

- **リセットボタン**: 手動設定をリセットし、自動調整の対象に戻す
- **一括リセット**: 複数のタスクの手動設定を一度にリセット可能
- **リセット時の動作**: リセット後は即座に自動調整ロジックが適用される

### 3.4 通知機能

- 優先度が自動調整されても、ユーザーへの通知は**行わない**
- ユーザーはタスク一覧で優先度の変化を確認できれば十分とする

---

## 4. 自動調整のロジック

### 4.1 基本的な調整ルール

優先度の自動調整は以下の要素を総合的に判断して行う：

#### 4.1.1 期限ベースの調整
- **期限が24時間以内**: 優先度を「緊急」に引き上げ
- **期限が3日以内**: 優先度を「重要」に引き上げ
- **期限が7日以上先**: 優先度を「通常」または「低優先度」に設定

#### 4.1.2 タスク完了時の調整
- タスクが完了した場合、関連する他のタスクの優先度を再評価
- ブロッキング依存関係があるタスクの優先度を引き上げ

#### 4.1.3 タスク追加時の調整
- 新規タスクは初期優先度として「通常」を設定
- 期限が設定されている場合は期限ベースのルールを適用

#### 4.1.4 更新時の調整
- 期限が変更された場合、新しい期限に基づいて再評価
- 依存関係が追加/削除された場合、影響を受けるタスクを再評価

### 4.2 調整の実行タイミング

- リアルタイムで実行（トリガー発生時に即座に調整）
- バックグラウンド処理として実装し、UI操作をブロックしない

---

## 5. 優先順位（実装優先度）

機能実装の優先順位は以下の通り：

### フェーズ1（必須機能）
1. **手動優先度調整UI機能**（ドロップダウンまたはボタンによる変更）
2. 基本的な優先度管理機能（データモデル、永続化）
3. 期限ベースの自動調整ロジック
4. 手動設定の優先機構（手動設定フラグの実装）

### フェーズ2（重要機能）
5. タスク完了時の関連タスク調整
6. タスク更新時の再評価機能
7. 手動設定リセット機能（自動調整への復帰）

### フェーズ3（拡張機能）
8. 依存関係に基づく優先度調整
9. 手動変更の履歴記録機能
10. 一括リセット機能（複数タスクの手動設定を一度にリセット）

---

## 6. 制約事項

### 6.1 利用環境
- **対象ユーザー**: 個人利用向け
- マルチユーザー対応は考慮しない（将来の拡張として検討可能）

### 6.2 技術的制約
- 自動調整処理はUI操作をブロックしてはならない
- 手動設定された優先度は永続化し、システム再起動後も保持される
- 優先度の変更履歴は最低限の記録にとどめる（ストレージ効率を考慮）

### 6.3 機能的制約
- 通知機能は実装しない
- 複雑な依存関係グラフの解析は初期バージョンでは対象外
- 優先度の調整は4段階の範囲内で行う

---

## 7. 想定される利用シナリオ

### シナリオ1: 期限が迫ったタスクの自動昇格
**状況**: ユーザーが「通常」優先度で来週のタスクを登録していたが、期限が24時間以内に迫った

**システムの動作**:
1. 定期的な再評価で期限が24時間以内であることを検出
2. 優先度を「緊急」に自動調整
3. タスク一覧で「緊急」として表示され、ユーザーが見落とさない

### シナリオ2: 依存タスク完了による優先度変更
**状況**: タスクA（優先度：通常）がタスクB（優先度：緊急）に依存している。タスクBが完了した

**システムの動作**:
1. タスクBの完了を検出
2. タスクAのブロッキング要因が解消されたことを認識
3. タスクAの優先度を「重要」に引き上げ（次に取り組むべきタスクとして強調）

### シナリオ3: 手動優先度調整の利用
**状況**: ユーザーが自動調整された優先度を変更したい

**ユーザーの操作**:
1. タスク一覧またはタスク詳細画面を開く
2. 優先度のドロップダウンメニューから「低優先度」を選択
3. 即座に優先度が「低優先度」に変更され、手動設定フラグが立つ

**システムの動作**:
1. 優先度を「低優先度」に更新
2. 手動設定フラグをONに設定
3. 以降、自動調整の対象外となる

### シナリオ4: 手動設定の優先（自動調整のスキップ）
**状況**: ユーザーが「低優先度」のタスクを意図的に設定したが、期限が24時間以内に迫った

**システムの動作**:
1. 通常であれば「緊急」に調整される状況
2. しかし、手動設定フラグが立っているため調整を**スキップ**
3. ユーザーの意図を尊重し、「低優先度」のまま維持

### シナリオ5: 手動設定のリセット
**状況**: ユーザーが以前に手動設定した優先度を解除し、自動調整に戻したい

**ユーザーの操作**:
1. タスク詳細画面でリセットボタンをクリック
2. 確認ダイアログで「自動調整に戻す」を選択

**システムの動作**:
1. 手動設定フラグをOFFに設定
2. 即座に自動調整ロジックを適用
3. 期限や依存関係に基づいて適切な優先度を再計算
4. 必要に応じて優先度を更新

### シナリオ6: 大量のタスク追加
**状況**: ユーザーが一度に10個のタスクを追加した

**システムの動作**:
1. 各タスクに初期優先度「通常」を設定
2. 期限が設定されているタスクは期限に基づいて調整
3. バックグラウンドで処理し、UI操作を妨げない

---

## 8. 成功基準

この機能が成功したと判断する基準：

1. **見落とし率の低減**: 重要なタスクの見落としが発生しない
2. **ユーザー満足度**: 手動での優先度管理負担が軽減される
3. **UI操作性**: 優先度の手動変更が直感的で分かりやすい（ユーザーテストで80%以上が「簡単」と評価）
4. **パフォーマンス**: 自動調整処理がUI操作に影響を与えない（100ms以内の応答）
5. **正確性**: 手動設定が自動調整によって上書きされない（エラー率0%）
6. **柔軟性**: 手動設定と自動調整を自由に切り替えられる（リセット機能が正常に動作）

---

## 9. 今後の拡張可能性

### 9.1 機械学習による優先度予測
ユーザーの完了パターンを学習し、より精度の高い優先度調整を実現

### 9.2 カスタマイズ可能な調整ルール
ユーザーが調整ロジックをカスタマイズできる設定機能

### 9.3 チーム利用への対応
複数ユーザー環境での優先度調整と競合解決

---

## 付録

### A. 用語定義
- **手動設定フラグ**: ユーザーが明示的に優先度を設定したことを示すフラグ。このフラグが立っている間は自動調整の対象外となる
- **手動優先度調整**: ユーザーがUIを通じて直接優先度を変更する機能。ドロップダウン、ボタン、またはドラッグ&ドロップで操作可能
- **手動設定リセット**: 手動設定フラグをOFFにし、タスクを自動調整の対象に戻す操作
- **ブロッキング依存**: あるタスクが別のタスクの完了を待つ必要がある依存関係
- **リアルタイム調整**: トリガー発生時に即座に実行される優先度調整

### B. 参考資料
- タスク管理ツールの一般的なベストプラクティス
- 優先度マトリクス（アイゼンハワーマトリクスなど）

---

**文書の終わり**
