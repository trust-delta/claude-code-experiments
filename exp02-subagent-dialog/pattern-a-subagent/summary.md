# パターンA: サブエージェント - 実験まとめ

## 実験概要

- **使用機能**: requirements-definer サブエージェント
- **タスク**: TODOアプリ「優先度自動調整機能」の要件定義
- **実験日**: 2025-11-29

## 対話フロー

```
ユーザー → メイン → サブエージェント → メイン → ユーザー
```

メインエージェントが中継役として介在し、サブエージェントとユーザー間の対話を仲介した。

## 観察された挙動

### セッション管理

- 各Task呼び出しでサブエージェントは自動終了
- コンテキストは保持されず、ファイルベースで状態管理

### 状態保持の仕組み

- 返された質問ごとに回答を新しいサブエージェントに再度投げる
- 作成された要件定義書ファイルを読み書きすることで要件の蓄積が可能

### 中継コスト

- メインが全ての質問・回答を中継
- トークン消費が増大（実験終了時 64%消費、Free space 36%）
- 情報が間接的になりニュアンスが失われるリスク

## 成果物

- [requirements-priority-auto-adjustment.md](../output/requirements-priority-auto-adjustment.md)
- **614行**、過剰に詳細な要件定義書
- **問題**: 指定したディレクトリ（pattern-a-subagent/output/）ではなく、ルートのoutput/に作成された

### 成果物の問題点

1. **指示に従わない出力先**
   - 指定: `pattern-a-subagent/output/`
   - 実際: `output/`（ルート直下）

2. **過剰な詳細度**
   - サブエージェント定義では示されていない項目まで網羅
   - シンプルな要件定義の依頼に対して過剰な成果物
   - 手動調整機能の詳細、変更履歴機能、確認ダイアログまで追加

## メイン自身の評価

実験終了時に「サブエージェントは対話的タスクに向いていると思いますか？」と質問したところ：

> 率直に言うと、サブエージェントは対話的タスクにはあまり向いていないと考えます。

**理由:**
1. ステートレスな設計との相性が悪い
2. 中継コストが高い
3. 本来の用途（探索・分析）との乖離

## 特徴

| 観点 | 評価 |
|------|------|
| 対話の自然さ | △ 中継が必要で不自然 |
| 効率性 | × コンテキスト再構築のオーバーヘッド |
| 成果物の品質 | ○ 構造化された要件定義書は生成できた |
| 適切な用途 | × 対話的タスクより探索・分析向き |
